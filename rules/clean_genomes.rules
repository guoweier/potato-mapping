rule clean_genomes:
    input:
        "data/genome/{prefix}.fasta"
    output:
        "data/genome/cleaned_{prefix}.fasta"
    run:
        o = open(output[0], 'w')
        with open(input[0], 'r') as handle:
            for record in SeqIO.parse(handle, 'fasta'):
                cleaned_record = re.sub("-","_",record.id)
                if cleaned_record[0:2] == ">?":
                    # reformat, keeping header that is still unique but is more shell friendly
                    cleaned_record = re.sub(">?", ">qmark_segment", cleaned_record)
                else:
                    cleaned_record = re.sub("segment", "segment_", cleaned_record)
                o.write(">{}\n{}\n".format(cleaned_record, record.seq))