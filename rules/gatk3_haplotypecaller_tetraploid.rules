rule gatk3_haplotypecaller_tetraploid:
    input:
        ref=config["genome"],
        fai=config["genome"]+".fai",
        dict=re.sub("(\.fasta$|\.fa$)", ".dict", config["genome"]),
        bam="data/dedup/4x_{sample}-{unit}-dedup-sorted.aln.bam",
        bai="data/dedup/4x_{sample}-{unit}-dedup-sorted.aln.bam.bai"
    params:
        hets=config["params"]["gatk_haplotypecaller"]["hets"]
    output:
        "data/calls/gatk/4x_{sample}-{unit}.g.vcf"
    shell:
        "gatk -R {input.ref} "
        "-T HaplotypeCaller "
        "-I {input.bam} "
        "-ERC GVCF "
        "--ploidy 4 "
        "-hets {params.hets} "
        "-o {output}"