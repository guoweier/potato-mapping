rule gatk4_gather_region_gvcfs:
    input:
        config["genome"],
        "fofn/{sample}-{unit}.fofn",
        get_region_gvcfs
    output:
        "data/calls/gatk_sample/{sample}-{unit}.g.vcf"
    log:
        "logs/gatk/{sample}-{unit}-cat.log"
    params:
        jarpath=config["params"]["gather_gvcfs"]["jarpath"],
        java_heap=config["params"]["gather_gvcfs"]["java_heap"],
        opt=config["params"]["gather_gvcfs"]["opt"]
    shell:
        "java {params.java_heap} -jar {params.jarpath} GatherVcfs "
        "--REFERENCE_SEQUENCE={input[0]} "
        "$(cat {input[1]} sed 's/^/--INPUT=/g') --OUTPUT={output} {params.opt} "
        ">2 {log}"
