rule gatk4_genotype_gvcfs:
    input:
        ref=config["genome"],
        dict=re.sub("(\.fasta$|\.fa$)", ".dict", config["genome"]),
        calls="data/calls/gatk_sample/all-calls.g.vcf",
        intervals="data/intervals/gatk-haplocaller.intervals"
    output:
        "data/calls/all-calls.vcf"
    log: "logs/gatk/gatk4-all-calls.vcf.log"
    params: config["params"]["gatk_genotype_gvcfs"]["opt"]
    shell: """
        gatk-launch GenotypeGVCFs \
        -R {input.ref} \
        --variant {input.calls} \
        -O {output} \
        -L tmp_chrom.intervals \
        {params} \
        2> {log} ;
        rm tmp_chrom.intervals
        """
