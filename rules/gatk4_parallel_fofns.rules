rule gatk4_parallel_fofn:
    input:
        units="units.tsv",
        intervals="data/intervals/gatk-haplocaller.intervals"
    output:
        "fofn/all-fofns.made"
    shell:
        """
        for i in $(cut -f 1-2 units.tsv | tail -n +2 | tr '\t' '-')
        do
            while read line
            do
                echo 'data/calls/gatk/'$i $(echo $line | sed -E 's/:|-/_/g' | sed 's/$/.g.vcf/g') | \
                sed 's/ /-/g' >> 'fofn/'$i'.fofn'
            done < {input.intervals}
        done
        touch {output}
        """
